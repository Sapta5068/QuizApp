from flask import Flask, render_template_string, request, session, redirect, url_for
import secrets

app = Flask(__name__)
app.secret_key = secrets.token_hex(16)

# Copy all QUIZ_DATA from previous artifact here
exec(open('quiz_data.py').read())

@app.route('/')
def home():
    return render_template_string(HOME_TPL, active='home')

@app.route('/about')
def about():
    return render_template_string(ABOUT_TPL, active='about')

@app.route('/timed-test')
def timed_test():
    return render_template_string(TIMED_TEST_TPL, active='timed')

@app.route('/timed-test/start/<int:duration>', methods=['GET', 'POST'])
def start_timed_test(duration):
    import random
    
    if duration not in [10, 20, 30]:
        return redirect(url_for('timed_test'))
    
    # Combine all questions from all categories
    all_questions = (QUIZ_DATA_GK + QUIZ_DATA_SCIENCE + QUIZ_DATA_SPORTS + 
                     QUIZ_DATA_TECHNOLOGY + QUIZ_DATA_ARTS + QUIZ_DATA_ENTERTAINMENT)
    
    # Generate random 20 questions
    if 'timed_questions' not in session or request.args.get('reset'):
        session['timed_questions'] = random.sample(range(len(all_questions)), 20)
        session['timed_answers'] = {}
        session['timed_duration'] = duration
        session['timed_start_time'] = None
    
    timed_questions_indices = session.get('timed_questions', [])
    timed_questions = [all_questions[i] for i in timed_questions_indices]
    
    if request.method == 'POST':
        # Save answers
        for key, value in request.form.items():
            if key.startswith('q_'):
                session['timed_answers'][key] = int(value)
        session.modified = True
        return redirect(url_for('timed_test_results'))
    
    return render_template_string(TIMED_QUIZ_TPL, questions=timed_questions, duration=duration, 
                                   enumerate=enumerate, active='timed', 
                                   saved_answers=session.get('timed_answers', {}))

@app.route('/timed-test/results')
def timed_test_results():
    import random
    
    all_questions = (QUIZ_DATA_GK + QUIZ_DATA_SCIENCE + QUIZ_DATA_SPORTS + 
                     QUIZ_DATA_TECHNOLOGY + QUIZ_DATA_ARTS + QUIZ_DATA_ENTERTAINMENT)
    
    timed_questions_indices = session.get('timed_questions', [])
    timed_questions = [all_questions[i] for i in timed_questions_indices]
    timed_answers = session.get('timed_answers', {})
    duration = session.get('timed_duration', 10)
    
    # Calculate score
    score = 0
    for idx, question in enumerate(timed_questions):
        user_answer = timed_answers.get(f'q_{idx}')
        if user_answer is not None and user_answer == question['answer']:
            score += 1
    
    total = len(timed_questions)
    percentage = round((score / total) * 100) if total > 0 else 0
    
    if percentage >= 80:
        message = "Outstanding Performance! ğŸŒŸ"
    elif percentage >= 60:
        message = "Great Job! ğŸ‘"
    elif percentage >= 40:
        message = "Good Effort! Keep Practicing! ğŸ’ª"
    else:
        message = "Don't Give Up! Practice Makes Perfect! ğŸ“š"
    
    # Clear session
    session.pop('timed_questions', None)
    session.pop('timed_answers', None)
    session.pop('timed_duration', None)
    
    return render_template_string(TIMED_RESULT_TPL, score=score, total=total, 
                                   percentage=percentage, message=message, 
                                   duration=duration, active='timed')

@app.route('/services')
def services():
    return render_template_string(SERVICES_TPL, active='services')

@app.route('/contact', methods=['GET', 'POST'])
def contact():
    sent = request.method == 'POST'
    return render_template_string(CONTACT_TPL, active='contact', sent=sent)

@app.route('/choose-type')
def choose_type():
    return render_template_string(CHOOSE_TPL, active='choose')

@app.route('/quiz/<quiz_type>', methods=['GET', 'POST'])
def quiz(quiz_type):
    quiz_map = {
        'general-knowledge': (QUIZ_DATA_GK, "General Knowledge"),
        'science': (QUIZ_DATA_SCIENCE, "Science"),
        'sports': (QUIZ_DATA_SPORTS, "Sports"),
        'technology': (QUIZ_DATA_TECHNOLOGY, "Technology"),
        'arts': (QUIZ_DATA_ARTS, "Arts & Literature"),
        'entertainment': (QUIZ_DATA_ENTERTAINMENT, "Entertainment")
    }
    
    if quiz_type not in quiz_map:
        return redirect(url_for('choose_type'))
    
    quiz_data, title = quiz_map[quiz_type]
    
    if request.method == 'POST':
        current = session.get('current_question', 0)
        answer = int(request.form.get('answer'))
        
        if answer == quiz_data[current]['answer']:
            session['score'] = session.get('score', 0) + 1
        
        current += 1
        session['current_question'] = current
        
        if current >= len(quiz_data):
            return redirect(url_for('results', quiz_type=quiz_type))
        
        return redirect(url_for('quiz', quiz_type=quiz_type))
    
    current = session.get('current_question', 0)
    
    if current >= len(quiz_data):
        session['current_question'] = 0
        session['score'] = 0
        current = 0
    
    return render_template_string(QUIZ_TPL, question=quiz_data[current], current=current, total=len(quiz_data), enumerate=enumerate, active='choose', title=title)

@app.route('/results/<quiz_type>')
def results(quiz_type):
    quiz_map = {
        'general-knowledge': (len(QUIZ_DATA_GK), "General Knowledge"),
        'science': (len(QUIZ_DATA_SCIENCE), "Science"),
        'sports': (len(QUIZ_DATA_SPORTS), "Sports"),
        'technology': (len(QUIZ_DATA_TECHNOLOGY), "Technology"),
        'arts': (len(QUIZ_DATA_ARTS), "Arts & Literature"),
        'entertainment': (len(QUIZ_DATA_ENTERTAINMENT), "Entertainment")
    }
    
    if quiz_type not in quiz_map:
        return redirect(url_for('choose_type'))
    
    total, title = quiz_map[quiz_type]
    score = session.get('score', 0)
    percentage = round((score / total) * 100)
    
    if percentage >= 80:
        message = "Excellent work! ğŸŒŸ"
    elif percentage >= 60:
        message = "Good job! ğŸ‘"
    elif percentage >= 40:
        message = "Not bad! Keep practicing! ğŸ’ª"
    else:
        message = "Keep trying! You'll do better next time! ğŸ“š"
    
    session['current_question'] = 0
    session['score'] = 0
    
    return render_template_string(RESULT_TPL, score=score, total=total, percentage=percentage, message=message, active='choose', quiz_type=quiz_type, title=title)

# HTML Templates
NAV = '''<nav style="background:#fff;padding:1rem 0;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:0;z-index:1000;">
<div style="max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center;">
<div style="font-size:1.5em;font-weight:bold;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">QuizMaster</div>
<ul style="list-style:none;display:flex;gap:1.5rem;align-items:center;flex-wrap:wrap;">
<li><a href="{{url_for('home')}}" style="text-decoration:none;color:#333;font-weight:500;padding:0.5rem 1rem;border-radius:5px;{%if active=='home'%}background:rgba(102,126,234,0.1);color:#667eea;{%endif%}">Home</a></li>
<li><a href="{{url_for('about')}}" style="text-decoration:none;color:#333;font-weight:500;padding:0.5rem 1rem;border-radius:5px;{%if active=='about'%}background:rgba(102,126,234,0.1);color:#667eea;{%endif%}">About</a></li>
<li><a href="{{url_for('services')}}" style="text-decoration:none;color:#333;font-weight:500;padding:0.5rem 1rem;border-radius:5px;{%if active=='services'%}background:rgba(102,126,234,0.1);color:#667eea;{%endif%}">Services</a></li>
<li><a href="{{url_for('timed_test')}}" style="text-decoration:none;color:#333;font-weight:500;padding:0.5rem 1rem;border-radius:5px;{%if active=='timed'%}background:rgba(102,126,234,0.1);color:#667eea;{%endif%}">Timed Test</a></li>
<li><a href="{{url_for('contact')}}" style="text-decoration:none;color:#333;font-weight:500;padding:0.5rem 1rem;border-radius:5px;{%if active=='contact'%}background:rgba(102,126,234,0.1);color:#667eea;{%endif%}">Contact</a></li>
<li><a href="{{url_for('choose_type')}}" style="text-decoration:none;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white !important;padding:0.6rem 1.5rem;border-radius:25px;">Choose Type</a></li>
</ul></div></nav>'''

BASE = '''<!DOCTYPE html><html><head><title>{{title}}</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;animation:fadeIn 0.5s ease-in}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes slideDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes scaleIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.slide-up{animation:slideUp 0.6s ease-out}.slide-down{animation:slideDown 0.6s ease-out}.scale-in{animation:scaleIn 0.5s ease-out}.stagger-1{animation-delay:0.1s}.stagger-2{animation-delay:0.2s}.stagger-3{animation-delay:0.3s}.stagger-4{animation-delay:0.4s}.stagger-5{animation-delay:0.5s}.stagger-6{animation-delay:0.6s}</style></head><body>'''

HOME_TPL = BASE.replace('{{title}}', 'QuizMaster - Home') + NAV + '''<div style="padding:40px 20px;display:flex;justify-content:center;align-items:center;min-height:calc(100vh - 80px)"><div class="scale-in" style="background:white;padding:40px;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);max-width:900px;width:100%;text-align:center"><h1 class="slide-down" style="color:#667eea;margin-bottom:20px;font-size:2.5em">ğŸ¯ Welcome to QuizMaster</h1><p class="slide-down stagger-1" style="color:#666;margin-bottom:30px;line-height:1.8;font-size:1.1em;opacity:0;animation-fill-mode:forwards">Challenge yourself with our interactive quizzes and test your knowledge across various topics! Whether you're a student, professional, or lifelong learner, QuizMaster offers an engaging way to expand your knowledge and track your progress.</p><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:30px 0;text-align:left"><div class="slide-up stagger-2" style="padding:20px;background:#f8f9fa;border-radius:10px;border-left:4px solid #667eea;opacity:0;animation-fill-mode:forwards"><h3 style="color:#667eea;margin-bottom:10px">ğŸ“š Multiple Topics</h3><p style="color:#666;font-size:0.95em">Explore quizzes across 6 different categories including General Knowledge, Science, Sports, Technology, Arts & Literature, and Entertainment.</p></div><div class="slide-up stagger-3" style="padding:20px;background:#f8f9fa;border-radius:10px;border-left:4px solid #667eea;opacity:0;animation-fill-mode:forwards"><h3 style="color:#667eea;margin-bottom:10px">â±ï¸ Learn at Your Pace</h3><p style="color:#666;font-size:0.95em">No time pressure or stress. Take your time to think through each question and learn from the experience at your own comfortable speed.</p></div><div class="slide-up stagger-4" style="padding:20px;background:#f8f9fa;border-radius:10px;border-left:4px solid #667eea;opacity:0;animation-fill-mode:forwards"><h3 style="color:#667eea;margin-bottom:10px">ğŸ† Track Your Progress</h3><p style="color:#666;font-size:0.95em">Get instant feedback on your performance with detailed scores and percentage results. See how well you know each topic and identify areas for improvement.</p></div></div><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-top:30px"><a href="{{url_for('choose_type')}}" class="slide-up stagger-5" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:25px 30px;border:none;border-radius:15px;font-size:1.2em;text-decoration:none;display:block;transition:transform 0.2s;box-shadow:0 5px 20px rgba(102,126,234,0.4);text-align:center;opacity:0;animation-fill-mode:forwards" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 25px rgba(102,126,234,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 20px rgba(102,126,234,0.4)'"><div style="font-size:2.5em;margin-bottom:10px">ğŸ“š</div><div style="font-weight:bold;margin-bottom:8px">Start Learning Now</div><div style="font-size:0.85em;opacity:0.9">Choose from 6 quiz categories</div></a><a href="{{url_for('timed_test')}}" class="slide-up stagger-6" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;padding:25px 30px;border:none;border-radius:15px;font-size:1.2em;text-decoration:none;display:block;transition:transform 0.2s;box-shadow:0 5px 20px rgba(240,147,251,0.4);text-align:center;opacity:0;animation-fill-mode:forwards" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 25px rgba(240,147,251,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 20px rgba(240,147,251,0.4)'"><div style="font-size:2.5em;margin-bottom:10px">â±ï¸</div><div style="font-weight:bold;margin-bottom:8px">Take Timed Test</div><div style="font-size:0.85em;opacity:0.9">Challenge yourself with time limits</div></a></div></div></div></body></html>'''

ABOUT_TPL = BASE.replace('{{title}}', 'About') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:900px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 style="color:#667eea;margin-bottom:25px;font-size:2.5em">About QuizMaster</h1><p style="color:#666;line-height:1.8;font-size:1.1em;margin-bottom:25px">QuizMaster is an innovative online quiz platform designed to make learning fun, engaging, and accessible to everyone. Our mission is to provide high-quality educational content that helps users test and improve their knowledge across various subjects.</p><h2 style="color:#333;margin-top:30px;margin-bottom:15px;font-size:1.8em">ğŸ“– Our Story</h2><p style="color:#666;line-height:1.8;font-size:1.05em;margin-bottom:25px">Founded in 2024, QuizMaster was created by a passionate team of educators, developers, and lifelong learners who believe that education should be accessible, enjoyable, and effective. We recognized that traditional learning methods often fail to engage modern learners, so we set out to create a platform that combines cutting-edge technology with proven pedagogical principles.</p><h2 style="color:#333;margin-top:30px;margin-bottom:15px;font-size:1.8em">ğŸ¯ What We Offer</h2><p style="color:#666;line-height:1.8;font-size:1.05em;margin-bottom:25px">Our platform features carefully curated quizzes spanning multiple categories including General Knowledge, Science, Sports, Technology, Arts & Literature, and Entertainment. Each quiz contains 20 thought-provoking questions designed to challenge your thinking while providing immediate feedback to enhance your learning journey. Whether you're preparing for exams, expanding your general knowledge, or simply enjoy trivia, QuizMaster has something for everyone.</p><h2 style="color:#333;margin-top:30px;margin-bottom:15px;font-size:1.8em">ğŸ’¡ Our Values</h2><div style="background:#f8f9fa;padding:25px;border-radius:15px;border-left:5px solid #667eea;margin-bottom:15px"><h3 style="color:#667eea;margin-bottom:10px">Excellence</h3><p style="color:#666;line-height:1.8">We are committed to providing the highest quality questions and user experience.</p></div><div style="background:#f8f9fa;padding:25px;border-radius:15px;border-left:5px solid #667eea;margin-bottom:15px"><h3 style="color:#667eea;margin-bottom:10px">Accessibility</h3><p style="color:#666;line-height:1.8">Education should be available to everyone, regardless of background or circumstance.</p></div><div style="background:#f8f9fa;padding:25px;border-radius:15px;border-left:5px solid #667eea;margin-bottom:15px"><h3 style="color:#667eea;margin-bottom:10px">Continuous Improvement</h3><p style="color:#666;line-height:1.8">We constantly update our content and platform based on user feedback and educational best practices.</p></div><div style="background:#f8f9fa;padding:25px;border-radius:15px;border-left:5px solid #667eea"><h3 style="color:#667eea;margin-bottom:10px">Inclusivity</h3><p style="color:#666;line-height:1.8">We create an environment where learners of all backgrounds can thrive and achieve their educational goals.</p></div></div></div></body></html>'''

SERVICES_TPL = BASE.replace('{{title}}', 'Services') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:900px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 style="color:#667eea;margin-bottom:25px;font-size:2.5em">Our Services</h1><p style="color:#666;line-height:1.8;font-size:1.1em;margin-bottom:30px">Discover the comprehensive range of services we offer to enhance your learning experience and help you achieve your educational goals.</p><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px;border-left:5px solid #667eea"><h2 style="color:#667eea;margin-bottom:15px;font-size:1.6em">ğŸ“ Interactive Quizzes</h2><p style="color:#666;line-height:1.8;font-size:1.05em;margin-bottom:10px">Access a wide variety of quizzes covering multiple subjects and difficulty levels. Our quiz library includes:</p><ul style="color:#666;line-height:1.8;margin-left:25px"><li>General Knowledge - Test your awareness of world facts and culture</li><li>Science - Explore physics, chemistry, biology, and more</li><li>Sports - Challenge your knowledge of athletics and competitions</li><li>Technology - Stay updated with tech trends and fundamentals</li><li>Arts & Literature - Dive into creativity and classic works</li><li>Entertainment - Have fun with movies, music, and pop culture</li></ul></div><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px;border-left:5px solid #667eea"><h2 style="color:#667eea;margin-bottom:15px;font-size:1.6em">ğŸ“Š Performance Analytics</h2><p style="color:#666;line-height:1.8;font-size:1.05em">Track your progress with detailed analytics and insights. After each quiz, receive:</p><ul style="color:#666;line-height:1.8;margin-left:25px"><li>Instant score calculation and percentage results</li><li>Performance feedback based on your achievement level</li><li>Visual progress indicators showing your completion status</li><li>Ability to retake quizzes to improve your scores</li></ul></div><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px;border-left:5px solid #667eea"><h2 style="color:#667eea;margin-bottom:15px;font-size:1.6em">ğŸ¯ Flexible Learning</h2><p style="color:#666;line-height:1.8;font-size:1.05em">Learn on your own terms with our user-friendly features:</p><ul style="color:#666;line-height:1.8;margin-left:25px"><li>No time limits - take as long as you need to answer</li><li>20 questions per category for comprehensive testing</li><li>Clean, distraction-free interface for better focus</li><li>Mobile-friendly design for learning on the go</li><li>Progress tracking within each quiz session</li></ul></div><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px;border-left:5px solid #667eea"><h2 style="color:#667eea;margin-bottom:15px;font-size:1.6em">ğŸŒŸ Quality Content</h2><p style="color:#666;line-height:1.8;font-size:1.05em">Every quiz question is carefully crafted to ensure:</p><ul style="color:#666;line-height:1.8;margin-left:25px"><li>Accuracy and reliability of information</li><li>Appropriate difficulty levels for general audiences</li><li>Clear, unambiguous question phrasing</li><li>Fair and balanced multiple-choice options</li><li>Educational value in every question</li></ul></div><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px;border-left:5px solid #667eea"><h2 style="color:#667eea;margin-bottom:15px;font-size:1.6em">ğŸ”’ Safe & Secure</h2><p style="color:#666;line-height:1.8;font-size:1.05em">Your learning journey is protected with:</p><ul style="color:#666;line-height:1.8;margin-left:25px"><li>Session-based progress tracking</li><li>No registration required to start learning</li><li>Privacy-focused design with minimal data collection</li><li>Secure platform infrastructure</li></ul></div></div></div></body></html>'''

CONTACT_TPL = BASE.replace('{{title}}', 'Contact') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:900px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 style="color:#667eea;margin-bottom:25px;font-size:2.5em">Contact Us</h1><p style="color:#666;line-height:1.8;font-size:1.1em;margin-bottom:30px">Have questions, feedback, or suggestions? We'd love to hear from you! Get in touch with us using any of the methods below, or simply fill out our contact form.</p><div style="background:#f8f9fa;padding:30px;margin:25px 0;border-radius:15px"><h2 style="color:#667eea;margin-bottom:20px;font-size:1.6em">ğŸ“ Get In Touch</h2><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px"><div style="background:white;padding:20px;border-radius:10px;border-left:4px solid #667eea"><div style="font-size:1.8em;margin-bottom:10px">ğŸ“§</div><strong style="color:#333;display:block;margin-bottom:5px">Email</strong><p style="color:#666;font-size:0.95em">support@quizmaster.com</p><p style="color:#999;font-size:0.85em;margin-top:5px">We typically respond within 24 hours</p></div><div style="background:white;padding:20px;border-radius:10px;border-left:4px solid #667eea"><div style="font-size:1.8em;margin-bottom:10px">ğŸ“±</div><strong style="color:#333;display:block;margin-bottom:5px">Phone</strong><p style="color:#666;font-size:0.95em">+1 (555) 123-4567</p><p style="color:#999;font-size:0.85em;margin-top:5px">Mon-Fri, 9 AM - 6 PM EST</p></div><div style="background:white;padding:20px;border-radius:10px;border-left:4px solid #667eea"><div style="font-size:1.8em;margin-bottom:10px">ğŸ“</div><strong style="color:#333;display:block;margin-bottom:5px">Address</strong><p style="color:#666;font-size:0.95em">123 Learning Street<br>Education City, EC 12345</p></div><div style="background:white;padding:20px;border-radius:10px;border-left:4px solid #667eea"><div style="font-size:1.8em;margin-bottom:10px">ğŸ•</div><strong style="color:#333;display:block;margin-bottom:5px">Business Hours</strong><p style="color:#666;font-size:0.95em">Monday - Friday<br>9:00 AM - 6:00 PM EST</p></div></div></div><h2 style="color:#667eea;margin-top:40px;margin-bottom:20px;font-size:1.6em">âœ‰ï¸ Send Us a Message</h2><p style="color:#666;line-height:1.8;margin-bottom:20px">Fill out the form below and we'll get back to you as soon as possible. Whether you have a question about our quizzes, need technical support, or want to provide feedback, we're here to help!</p><form method="POST" style="margin-top:25px"><div style="margin-bottom:20px"><label style="display:block;margin-bottom:8px;color:#333;font-weight:600">Your Name *</label><input type="text" name="name" required style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;font-family:inherit" placeholder="Enter your full name"></div><div style="margin-bottom:20px"><label style="display:block;margin-bottom:8px;color:#333;font-weight:600">Email Address *</label><input type="email" name="email" required style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;font-family:inherit" placeholder="your.email@example.com"></div><div style="margin-bottom:20px"><label style="display:block;margin-bottom:8px;color:#333;font-weight:600">Subject *</label><input type="text" name="subject" required style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;font-family:inherit" placeholder="What is this regarding?"></div><div style="margin-bottom:20px"><label style="display:block;margin-bottom:8px;color:#333;font-weight:600">Message *</label><textarea name="message" required style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;font-family:inherit;min-height:150px;resize:vertical" placeholder="Tell us more about your inquiry..."></textarea></div><button type="submit" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:15px 35px;border:none;border-radius:25px;font-size:1.1em;cursor:pointer;font-weight:600">Send Message</button></form>{%if sent%}<div style="background:#d4edda;border:1px solid #c3e6cb;color:#155724;padding:15px;border-radius:8px;margin-top:25px"><strong>âœ“ Success!</strong> Your message has been sent successfully. We'll get back to you soon!</div>{%endif%}<div style="background:#e7f3ff;padding:25px;border-radius:10px;margin-top:40px;border-left:4px solid #667eea"><h3 style="color:#667eea;margin-bottom:10px">ğŸ’¬ Frequently Asked Questions</h3><p style="color:#666;line-height:1.8;font-size:0.95em">Before reaching out, check our FAQ section for quick answers to common questions about using QuizMaster, scoring, and quiz categories.</p></div></div></div></body></html>'''

CHOOSE_TPL = BASE.replace('{{title}}', 'Choose Quiz') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div class="scale-in" style="background:white;padding:40px;border-radius:20px;max-width:1100px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 class="slide-down" style="color:#667eea;text-align:center;font-size:2.5em;margin-bottom:15px">Choose Your Quiz Type</h1><p class="slide-down stagger-1" style="text-align:center;color:#666;font-size:1.1em;line-height:1.8;margin-bottom:35px;opacity:0;animation-fill-mode:forwards">Select a quiz category below to begin your learning journey. Each quiz contains 20 carefully crafted questions designed to test and expand your knowledge!</p><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;margin-top:30px">
<a href="{{url_for('quiz',quiz_type='general-knowledge')}}" class="slide-up stagger-2" style="opacity:0;animation-fill-mode:forwards;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(102,126,234,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(102,126,234,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(102,126,234,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">ğŸŒ</div><h3 style="font-size:1.4em;margin-bottom:10px">General Knowledge</h3><p style="font-size:0.9em;opacity:0.9;line-height:1.5">Test your awareness of world facts, geography, history, and culture</p><div style="margin-top:15px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
<a href="{{url_for('quiz',quiz_type='science')}}" class="slide-up stagger-3" style="opacity:0;animation-fill-mode:forwards;background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(17,153,142,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(17,153,142,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(17,153,142,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">ğŸ”¬</div><h3 style="font-size:1.4em;margin-bottom:10px">Science</h3><p style="font-size:0.9em;opacity:0.9;line-height:1.5">Explore physics, chemistry, biology, and scientific discoveries</p><div style="margin-top:15px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
<a href="{{url_for('quiz',quiz_type='sports')}}" class="slide-up stagger-4" style="opacity:0;animation-fill-mode:forwards;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(240,147,251,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(240,147,251,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(240,147,251,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">âš½</div><h3 style="font-size:1.4em;margin-bottom:10px">Sports</h3><p style="font-size:0.9em;opacity:0.9;line-height:1.5">Challenge your knowledge of athletics, rules, and competitions</p><div style="margin-top:15px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
<a href="{{url_for('quiz',quiz_type='technology')}}" class="slide-up stagger-5" style="opacity:0;animation-fill-mode:forwards;background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(79,172,254,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(79,172,254,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(79,172,254,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">ğŸ’»</div><h3 style="font-size:1.4em;margin-bottom:10px">Technology</h3><p style="font-size:0.9em;opacity:0.9;line-height:1.5">Test your tech knowledge from computers to programming</p><div style="margin-top:15px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
<a href="{{url_for('quiz',quiz_type='arts')}}" class="slide-up stagger-6" style="opacity:0;animation-fill-mode:forwards;background:linear-gradient(135deg,#fa709a 0%,#fee140 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(250,112,154,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(250,112,154,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(250,112,154,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">ğŸ¨</div><h3 style="font-size:1.4em;margin-bottom:10px">Arts & Literature</h3><p style="font-size:0.9em;opacity:0.9;line-height:1.5">Dive into paintings, music, poetry, and classic literature</p><div style="margin-top:15px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
<a href="{{url_for('quiz',quiz_type='entertainment')}}" class="slide-up" style="opacity:0;animation-fill-mode:forwards;animation-delay:0.7s;background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);padding:35px;border-radius:15px;text-align:center;text-decoration:none;color:#333;transition:all 0.3s;box-shadow:0 5px 15px rgba(168,237,234,0.3)" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(168,237,234,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(168,237,234,0.3)'"><div style="font-size:3.5em;margin-bottom:15px">ğŸ¬</div><h3 style="font-size:1.4em;margin-bottom:10px">Entertainment</h3><p style="font-size:0.9em;opacity:0.8;line-height:1.5">Explore movies, TV shows, music, and pop culture</p><div style="margin-top:15px;padding:8px 20px;background:rgba(0,0,0,0.1);border-radius:20px;display:inline-block;font-size:0.85em">20 Questions</div></a>
</div><div class="slide-up" style="opacity:0;animation-fill-mode:forwards;animation-delay:0.8s;background:#e7f3ff;padding:25px;border-radius:15px;margin-top:40px;text-align:center;border-left:4px solid #667eea"><p style="color:#666;line-height:1.8;font-size:1.05em">ğŸ’¡ <strong>Pro Tip:</strong> Take your time with each question. There's no time limit, so focus on learning rather than rushing through!</p></div></div></div></body></html>'''

QUIZ_TPL = BASE.replace('{{title}}', '{{title}} Quiz') + NAV + '''<div style="padding:40px 20px"><div style="background:white;padding:40px;border-radius:20px;max-width:700px;margin:0 auto"><div style="background:#e0e0e0;height:10px;border-radius:10px;margin-bottom:30px"><div style="background:linear-gradient(90deg,#667eea,#764ba2);height:100%;width:{{(current+1)/total*100}}%;border-radius:10px"></div></div><div style="color:#667eea;margin-bottom:20px">Question {{current+1}} of {{total}}</div><div style="font-size:1.3em;color:#333;margin-bottom:30px">{{question.question}}</div><form method="POST">{%for i,opt in enumerate(question.options)%}<div style="margin:15px 0"><input type="radio" id="opt{{i}}" name="answer" value="{{i}}" required style="display:none"><label for="opt{{i}}" style="display:block;padding:15px 20px;background:#f8f9fa;border:2px solid #e0e0e0;border-radius:10px;cursor:pointer">{{opt}}</label></div>{%endfor%}<button type="submit" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:15px 40px;border:none;border-radius:50px;font-size:1.1em;cursor:pointer;margin-top:20px">{%if current+1==total%}Finish{%else%}Next{%endif%}</button></form></div></div><style>input[type="radio"]:checked+label{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)!important;color:white!important;border-color:#667eea!important}</style></body></html>'''

RESULT_TPL = BASE.replace('{{title}}', 'Results') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div class="scale-in" style="background:white;padding:40px;border-radius:20px;max-width:600px;margin:0 auto;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 class="slide-down" style="color:#667eea;font-size:2.5em;margin-bottom:15px">Quiz Complete! ğŸ‰</h1><p class="slide-down stagger-1" style="color:#666;font-size:1.1em;margin-bottom:30px;opacity:0;animation-fill-mode:forwards">Great job completing the <strong>{{title}}</strong> quiz!</p><div class="scale-in stagger-2" style="width:220px;height:220px;border-radius:50%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;flex-direction:column;justify-content:center;align-items:center;margin:30px auto;box-shadow:0 15px 40px rgba(102,126,234,0.4);opacity:0;animation-fill-mode:forwards"><div style="color:white;font-size:3.5em;font-weight:bold;margin-bottom:5px">{{score}}/{{total}}</div><div style="color:rgba(255,255,255,0.9);font-size:1.1em">Questions</div></div><div class="slide-up stagger-3" style="opacity:0;animation-fill-mode:forwards;background:{%if percentage>=80%}#d4edda{%elif percentage>=60%}#fff3cd{%else%}#f8d7da{%endif%};padding:25px;border-radius:15px;margin:30px 0;border-left:5px solid {%if percentage>=80%}#28a745{%elif percentage>=60%}#ffc107{%else%}#dc3545{%endif%}"><div style="font-size:1.5em;color:#333;margin-bottom:10px;font-weight:600">{{message}}</div><div style="font-size:2em;color:{%if percentage>=80%}#28a745{%elif percentage>=60%}#f0ad4e{%else%}#dc3545{%endif%};font-weight:bold;margin-top:10px">{{percentage}}%</div></div><div class="slide-up stagger-4" style="opacity:0;animation-fill-mode:forwards;background:#f8f9fa;padding:20px;border-radius:10px;margin:25px 0"><h3 style="color:#333;margin-bottom:15px;font-size:1.2em">Performance Breakdown</h3><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;text-align:left"><div style="background:white;padding:15px;border-radius:8px;border-left:3px solid #28a745"><div style="color:#666;font-size:0.85em;margin-bottom:5px">Correct Answers</div><div style="color:#333;font-size:1.5em;font-weight:bold">{{score}}</div></div><div style="background:white;padding:15px;border-radius:8px;border-left:3px solid #dc3545"><div style="color:#666;font-size:0.85em;margin-bottom:5px">Incorrect Answers</div><div style="color:#333;font-size:1.5em;font-weight:bold">{{total - score}}</div></div></div></div><div class="slide-up stagger-5" style="opacity:0;animation-fill-mode:forwards;margin-top:30px"><a href="{{url_for('quiz',quiz_type=quiz_type)}}" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:15px 35px;border:none;border-radius:50px;text-decoration:none;display:inline-block;margin:10px;font-size:1.05em;font-weight:600;transition:transform 0.2s" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ”„ Try Again</a><a href="{{url_for('choose_type')}}" style="background:#6c757d;color:white;padding:15px 35px;border:none;border-radius:50px;text-decoration:none;display:inline-block;margin:10px;font-size:1.05em;font-weight:600;transition:transform 0.2s" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ“š Choose Another Quiz</a></div><div class="slide-up stagger-6" style="opacity:0;animation-fill-mode:forwards;background:#e7f3ff;padding:20px;border-radius:10px;margin-top:30px;border-left:4px solid #667eea"><p style="color:#666;font-size:0.95em;line-height:1.6"><strong>ğŸ’¡ Did you know?</strong> Regular practice helps improve retention. Try retaking this quiz after a few days to see how much you remember!</p></div></div></div></body></html>'''

TIMED_TEST_TPL = BASE.replace('{{title}}', 'Timed Test') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:1000px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><h1 style="color:#667eea;text-align:center;font-size:2.5em;margin-bottom:15px">â±ï¸ Take Timed Test (TTT)</h1><p style="text-align:center;color:#666;font-size:1.1em;line-height:1.8;margin-bottom:20px">Challenge yourself with a timed quiz! Select your preferred time limit and answer 20 random questions from all categories before time runs out.</p><div style="background:#fff3cd;padding:20px;border-radius:10px;border-left:4px solid #ffc107;margin-bottom:35px"><p style="color:#856404;line-height:1.6;margin:0"><strong>âš ï¸ Important:</strong> Once you start, the timer cannot be paused. Make sure you have uninterrupted time before beginning the test. Questions are randomly selected from all 6 categories!</p></div><h2 style="color:#333;text-align:center;margin-bottom:25px;font-size:1.5em">Choose Your Time Limit</h2><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:30px;margin-top:30px"><a href="{{url_for('start_timed_test',duration=10)}}?reset=1" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);padding:40px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(240,147,251,0.3);position:relative;overflow:hidden" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(240,147,251,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(240,147,251,0.3)'"><div style="font-size:4em;margin-bottom:15px">âš¡</div><h3 style="font-size:1.8em;margin-bottom:10px;font-weight:bold">10 Minutes</h3><p style="font-size:0.95em;opacity:0.9;line-height:1.5;margin-bottom:15px">Quick challenge for sharp minds</p><div style="background:rgba(255,255,255,0.2);padding:10px 25px;border-radius:25px;display:inline-block;font-size:0.9em;font-weight:600">20 Random Questions</div><div style="position:absolute;top:10px;right:10px;background:rgba(255,255,255,0.3);padding:5px 12px;border-radius:15px;font-size:0.8em">Fast Pace</div></a><a href="{{url_for('start_timed_test',duration=20)}}?reset=1" style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);padding:40px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(79,172,254,0.3);position:relative;overflow:hidden" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(79,172,254,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(79,172,254,0.3)'"><div style="font-size:4em;margin-bottom:15px">â³</div><h3 style="font-size:1.8em;margin-bottom:10px;font-weight:bold">20 Minutes</h3><p style="font-size:0.95em;opacity:0.9;line-height:1.5;margin-bottom:15px">Balanced time for thoughtful answers</p><div style="background:rgba(255,255,255,0.2);padding:10px 25px;border-radius:25px;display:inline-block;font-size:0.9em;font-weight:600">20 Random Questions</div><div style="position:absolute;top:10px;right:10px;background:rgba(255,255,255,0.3);padding:5px 12px;border-radius:15px;font-size:0.8em">Recommended</div></a><a href="{{url_for('start_timed_test',duration=30)}}?reset=1" style="background:linear-gradient(135deg,#11998e 0%,#38ef7d 100%);padding:40px;border-radius:15px;text-align:center;text-decoration:none;color:white;transition:all 0.3s;box-shadow:0 5px 15px rgba(17,153,142,0.3);position:relative;overflow:hidden" onmouseover="this.style.transform='translateY(-10px)';this.style.boxShadow='0 15px 40px rgba(17,153,142,0.5)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 15px rgba(17,153,142,0.3)'"><div style="font-size:4em;margin-bottom:15px">ğŸ¯</div><h3 style="font-size:1.8em;margin-bottom:10px;font-weight:bold">30 Minutes</h3><p style="font-size:0.95em;opacity:0.9;line-height:1.5;margin-bottom:15px">Relaxed pace for careful consideration</p><div style="background:rgba(255,255,255,0.2);padding:10px 25px;border-radius:25px;display:inline-block;font-size:0.9em;font-weight:600">20 Random Questions</div><div style="position:absolute;top:10px;right:10px;background:rgba(255,255,255,0.3);padding:5px 12px;border-radius:15px;font-size:0.8em">Extended</div></a></div><div style="background:#e7f3ff;padding:25px;border-radius:15px;margin-top:40px;border-left:4px solid #667eea"><h3 style="color:#667eea;margin-bottom:15px">ğŸ“‹ Test Features</h3><ul style="color:#666;line-height:2;text-align:left;list-style-position:inside"><li>âœ“ 20 randomly selected questions from all categories</li><li>âœ“ Live countdown timer showing remaining time</li><li>âœ“ Automatic submission when time expires</li><li>âœ“ Answer any questions in any order</li><li>âœ“ Review and change answers before time runs out</li><li>âœ“ Instant results with detailed performance breakdown</li></ul></div></div></div></body></html>'''

TIMED_QUIZ_TPL = BASE.replace('{{title}}', 'Timed Quiz') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:900px;margin:0 auto;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><div style="position:sticky;top:100px;background:white;z-index:100;padding-bottom:20px;border-bottom:2px solid #e0e0e0;margin-bottom:30px"><div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px"><h1 style="color:#667eea;font-size:2em;margin:0">â±ï¸ Timed Test</h1><div id="timer" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;padding:15px 30px;border-radius:50px;font-size:1.5em;font-weight:bold;box-shadow:0 5px 15px rgba(240,147,251,0.4)">{{duration}}:00</div></div><p style="color:#666;margin-top:10px;margin-bottom:0">Answer all 20 questions before time runs out. You can change your answers anytime before submitting or time expires.</p></div><form method="POST" id="quizForm">{%for idx,q in enumerate(questions)%}<div style="background:#f8f9fa;padding:25px;border-radius:15px;margin-bottom:25px;border-left:4px solid #667eea"><div style="color:#667eea;font-weight:bold;margin-bottom:10px">Question {{idx+1}} of 20</div><div style="font-size:1.2em;color:#333;margin-bottom:20px;line-height:1.6">{{q.question}}</div><div style="display:grid;gap:12px">{%for i,opt in enumerate(q.options)%}<label style="display:flex;align-items:center;padding:15px;background:white;border:2px solid #e0e0e0;border-radius:10px;cursor:pointer;transition:all 0.3s" onmouseover="this.style.borderColor='#667eea';this.style.background='#f0f4ff'" onmouseout="if(!this.querySelector('input').checked){this.style.borderColor='#e0e0e0';this.style.background='white'}"><input type="radio" name="q_{{idx}}" value="{{i}}" {%if saved_answers.get('q_'+idx|string)==i%}checked{%endif%} style="margin-right:12px;width:18px;height:18px;cursor:pointer" onchange="this.parentElement.parentElement.querySelectorAll('label').forEach(l=>{l.style.borderColor='#e0e0e0';l.style.background='white';l.style.fontWeight='normal'});this.parentElement.style.borderColor='#667eea';this.parentElement.style.background='#f0f4ff';this.parentElement.style.fontWeight='600'"><span style="flex:1">{{opt}}</span></label>{%endfor%}</div></div>{%endfor%}<div style="text-align:center;margin-top:40px;padding-top:30px;border-top:2px solid #e0e0e0"><button type="submit" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:18px 50px;border:none;border-radius:50px;font-size:1.3em;cursor:pointer;font-weight:bold;box-shadow:0 5px 20px rgba(102,126,234,0.4);transition:transform 0.2s" onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform='translateY(0)'">Submit Test ğŸ“</button><p style="color:#999;margin-top:15px;font-size:0.9em">Make sure you've answered all questions before submitting!</p></div></form></div></div><script>
let timeLeft={{duration}}*60;const timer=document.getElementById('timer');const form=document.getElementById('quizForm');
function updateTimer(){let m=Math.floor(timeLeft/60);let s=timeLeft%60;timer.textContent=m+':'+(s<10?'0':'')+s;
if(timeLeft<=60){timer.style.background='linear-gradient(135deg,#ff6b6b 0%,#ee5a6f 100%)';timer.style.animation='pulse 1s infinite'}
if(timeLeft<=0){clearInterval(interval);form.submit()}timeLeft--}
const interval=setInterval(updateTimer,1000);
document.querySelectorAll('input[type="radio"]').forEach(r=>{if(r.checked){r.parentElement.style.borderColor='#667eea';r.parentElement.style.background='#f0f4ff';r.parentElement.style.fontWeight='600'}});
</script><style>@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}</style></body></html>'''

TIMED_RESULT_TPL = BASE.replace('{{title}}', 'Timed Test Results') + NAV + '''<div style="padding:40px 20px;min-height:calc(100vh - 80px)"><div style="background:white;padding:40px;border-radius:20px;max-width:700px;margin:0 auto;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px;border-radius:15px 15px 0 0;margin:-40px -40px 30px -40px"><h1 style="font-size:2.5em;margin-bottom:10px">â±ï¸ Timed Test Complete!</h1><p style="font-size:1.1em;opacity:0.9">{{duration}}-Minute Challenge</p></div><div style="width:240px;height:240px;border-radius:50%;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);display:flex;flex-direction:column;justify-content:center;align-items:center;margin:30px auto;box-shadow:0 15px 40px rgba(240,147,251,0.5)"><div style="color:white;font-size:4em;font-weight:bold;margin-bottom:5px">{{score}}/{{total}}</div><div style="color:rgba(255,255,255,0.95);font-size:1.2em">Questions</div></div><div style="background:{%if percentage>=80%}#d4edda{%elif percentage>=60%}#fff3cd{%else%}#f8d7da{%endif%};padding:30px;border-radius:15px;margin:30px 0;border-left:6px solid {%if percentage>=80%}#28a745{%elif percentage>=60%}#ffc107{%else%}#dc3545{%endif%}"><div style="font-size:1.6em;color:#333;margin-bottom:15px;font-weight:bold">{{message}}</div><div style="font-size:2.5em;color:{%if percentage>=80%}#28a745{%elif percentage>=60%}#f0ad4e{%else%}#dc3545{%endif%};font-weight:bold">{{percentage}}%</div><p style="color:#666;margin-top:10px;font-size:0.95em">Accuracy Rate</p></div><div style="background:#f8f9fa;padding:25px;border-radius:15px;margin:30px 0"><h3 style="color:#333;margin-bottom:20px;font-size:1.3em">ğŸ“Š Detailed Performance</h3><div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px"><div style="background:white;padding:20px;border-radius:10px;border-top:4px solid #28a745"><div style="color:#666;font-size:0.9em;margin-bottom:8px">Correct</div><div style="color:#28a745;font-size:2em;font-weight:bold">{{score}}</div></div><div style="background:white;padding:20px;border-radius:10px;border-top:4px solid #dc3545"><div style="color:#666;font-size:0.9em;margin-bottom:8px">Incorrect</div><div style="color:#dc3545;font-size:2em;font-weight:bold">{{total-score}}</div></div><div style="background:white;padding:20px;border-radius:10px;border-top:4px solid #667eea"><div style="color:#666;font-size:0.9em;margin-bottom:8px">Time Limit</div><div style="color:#667eea;font-size:2em;font-weight:bold">{{duration}}m</div></div></div></div><div style="margin-top:35px"><a href="{{url_for('timed_test')}}" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;padding:16px 40px;border:none;border-radius:50px;text-decoration:none;display:inline-block;margin:10px;font-size:1.1em;font-weight:bold;transition:transform 0.2s;box-shadow:0 5px 15px rgba(240,147,251,0.4)" onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform='translateY(0)'">â±ï¸ Try Another Time</a><a href="{{url_for('choose_type')}}" style="background:#6c757d;color:white;padding:16px 40px;border:none;border-radius:50px;text-decoration:none;display:inline-block;margin:10px;font-size:1.1em;font-weight:bold;transition:transform 0.2s" onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ“š Regular Quizzes</a></div><div style="background:#fff3cd;padding:25px;border-radius:15px;margin-top:35px;border-left:4px solid #ffc107;text-align:left"><h4 style="color:#856404;margin-bottom:12px;font-size:1.1em">ğŸ¯ Performance Tips</h4><ul style="color:#856404;line-height:1.8;padding-left:20px"><li>Practice regularly to improve speed and accuracy</li><li>Try different time limits to find your optimal pace</li><li>Review incorrect answers to learn from mistakes</li><li>Start with longer durations and work your way down</li></ul></div></div></div></body></html>'''

if __name__ == '__main__':
    app.run(debug=True)